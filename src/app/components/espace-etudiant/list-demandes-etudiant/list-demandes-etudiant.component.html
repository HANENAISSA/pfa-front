<ng-container>
  <div class="page-header card">
    <div class="row align-items-end">
      <div class="col-lg-8">
        <div class="page-header-title">
          <span
            ><i
              class="icofont icofont-home"
              style="background-color: #f4a024"
            ></i
          ></span>
          <div class="d-inline">
            <span class="d-block"><h4>Mes demandes de stage</h4></span>
            <span>Mes demandes de stage</span>
          </div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="page-header-breadcrumb">
          <ul class="breadcrumb">
            <li class="breadcrumb-item">
              <a [routerLink]="'/'">
                <i class="icofont icofont-home" style="color: #294a70"></i>
              </a>
            </li>
            <li class="breadcrumb-item">
              <a>Mes demandes de stage</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <!-- Page-header end -->
  <div class="row">
    <div class="col-lg-12">
      <div class="md-tabs">
        <ngb-tabset (tabChange)="changeEtat($event)">
          <ngb-tab title="DEMANDES NON DECIDÉES" [id]="3">
            <ng-template ngbTabContent>
              <div class="m-t-15">
                <div class="card">
                  <div class="col-sm-12">
                    <div class="card-header">
                      <h5 class="card-header-text">Liste des demandes</h5>
                    </div>

                    <div class="container">
                      <div class="row">
                        <div class="col-md-6 col-lg-5 offset-lg-1">
                          <div class="pcoded-search">
                            <div class="pcoded-search-box">
                              <input
                                type="text"
                                placeholder="Rechercher"
                                name="search"
                                [(ngModel)]="searchText"
                                autocomplete="off"
                              />
                              <span class="search-icon"
                                ><i class="ti-search" aria-hidden="true"></i
                              ></span>
                            </div>
                          </div>
                        </div>

                        <div class="col-md-6 col-lg-3 offset-lg-2">
                          <div class="input-group">
                            <select
                              ngModel="{{ this.year }}"
                              name="year"
                              class="form-control"
                              (change)="this.changeYear($event.target.value)"
                            >
                            <ng-container *ngFor="let item of this.listYears">
                              <option [value]="item.year">{{ item.year }}</option>
                            </ng-container>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="table-responsive" >
                      <div style="margin: 5px; ">
                        <table class="table table-hover" style="width: 100%;">
                          <thead>
                            <ng-container matColumnDef="actions">
                              <mat-header-cell *matHeaderCellDef>
                                Actions
                              </mat-header-cell>
                              <mat-cell *matCellDef="let row">
                                <button mat-button>Edit</button>
                              </mat-cell>
                            </ng-container>
                            <tr style="text-align: center">
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="nom_societe">Entreprise<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="libelle_domaine" >Domaine entreprise<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="titre">Titre<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="type" >Type<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="id_etat_offre_stage" >Etat offre<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="date_demande" data-type="date" >Date demande<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col"></th>

                              <!-- <th scope="col">Entreprise</th>
                              <th scope="col">Domaine entreprise</th>
                              <th scope="col">Titre</th>
                              <th scope="col">Type</th>
                              <th scope="col">Etat offre</th>
                              <th scope="col">Date début</th>
                              <th scope="col"></th> -->
                            </tr>
                          </thead>
                          <ng-container
                            *ngIf="
                              this.listdemande.length > 0 &&
                              this.listdemande[0] !== null
                            "
                          >
                            <tbody
                              *ngFor="
                                let demande of this.listdemande
                                  | filter: searchText | slice: (page-1) * pageSize : page * pageSize ; let i = index
                              "
                            >
                              <tr style="text-align: center">
                                <th scope="row">{{ demande.nom_societe }}</th>
                                <td scope="row">{{ demande.libelle_domaine }}</td>
                                <td scope="row">{{ demande.titre }}</td>
                                <td scope="row">{{ demande.type }}</td>

                                <td *ngIf="this.demande.id_etat_offre_stage === 1">Ouvert</td>
                                <td *ngIf="this.demande.id_etat_offre_stage === 2">Fermé</td>

                                <td>
                                  {{
                                    this.sharedService.formatDate(
                                      demande.date_demande,
                                      true
                                    )
                                  }}
                                </td>

                                <td>
                                  <button
                                    class="btn hor-grd ml-2"
                                    id="{{ demande.id_offre_stage }}"
                                    (click)="showDemandeDetails(demande)"
                                    style="background-color: #878787"
                                  >
                                    <i class="icofont icofont-eye-alt" style="color: white;"></i>
                                  </button>
                                </td>
                              </tr>
                            </tbody>
                          </ng-container>
                          <ng-container *ngIf="this.listdemande.length === 0">
                            <tbody>
                              <tr style="text-align: center">
                                <td colspan="5">
                                  AUCUNE DEMANDE NON DÉCIDÉES POUR L'ANNÉE
                                  {{ this.year }} !
                                </td>
                              </tr>
                            </tbody>
                          </ng-container>
                          <ng-container *ngIf="this.listdemande[0] === null">
                            <tbody>
                              <tr style="text-align: center">
                                <td colspan="5">Chargement ...</td>
                              </tr>
                            </tbody>
                          </ng-container>
                        </table>
                        <!-- Pagination  -->
                        <div class="d-flex justify-content-between p-2">
                          <ngb-pagination
                            [(page)]="page"
                            [pageSize]="pageSize"
                            [collectionSize]="listdemande.length"
                          >
                          </ngb-pagination>
                          <!-- Items Par Page  -->
                          <div>
                            Objets par page
:
                            <select
                              class="custom-select"
                              style="width: auto"
                              name="pageSize"
                              (change)="handlePageSizeChange($event)"
                            >
                              <option
                                *ngFor="let size of pageSizes"
                                [ngValue]="size"
                              >
                                {{ size }}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                    <!-- </app-card> -->
                  </div>
                </div>
              </div>
            </ng-template>
          </ngb-tab>

          <ngb-tab title="ACCEPTÉES POUR UN ENTRETIEN" [id]="1">
            <ng-template ngbTabContent>
              <div class="m-t-15">
                <!-- info card start -->
                <div class="card">
                  <div class="col-sm-12">
                    <div class="card-header">
                      <h5 class="card-header-text">Liste des demandes</h5>
                    </div>

                    <div class="container">
                      <div class="row">
                        <div class="col-md-6 col-lg-5 offset-lg-1">
                          <div class="pcoded-search">
                            <div class="pcoded-search-box">
                              <input
                                type="text"
                                placeholder="Rechercher"
                                name="search"
                                [(ngModel)]="searchText"
                                autocomplete="off"
                              />
                              <span class="search-icon"
                                ><i class="ti-search" aria-hidden="true"></i
                              ></span>
                            </div>
                          </div>
                        </div>

                        <div class="col-md-6 col-lg-3 offset-lg-2">
                          <div class="input-group">
                            <select
                              ngModel="{{ this.year }}"
                              name="year"
                              class="form-control"
                              (change)="this.changeYear($event.target.value)"
                            >
                            <ng-container *ngFor="let item of this.listYears">
                              <option [value]="item.year">{{ item.year }}</option>
                            </ng-container>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="table-responsive">
                      <div style="margin: 60px; ">
                        <table class="table table-hover">
                          <thead>
                            <ng-container matColumnDef="actions">
                              <mat-header-cell *matHeaderCellDef>
                                Actions
                              </mat-header-cell>
                              <mat-cell *matCellDef="let row">
                                <button mat-button>Edit</button>
                              </mat-cell>
                            </ng-container>
                            <tr style="text-align: center">
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="nom_societe">Entreprise<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="libelle_domaine" >Domaine entreprise<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="titre">Titre<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="type" >Type<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="id_etat_offre_stage" >Etat offre<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="date_demande" data-type="date" >Date demande<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col"></th>

                            </tr>
                          </thead>
                          <ng-container
                            *ngIf="
                              this.listdemande.length > 0 &&
                              this.listdemande[0] !== null
                            "
                          >
                            <tbody
                              *ngFor="
                                let demande of this.listdemande
                                  | filter: searchText
                                  | slice
                                    : (page - 1) * pageSize
                                    : page * pageSize;
                                let i = index
                              "
                            >
                              <tr style="text-align: center">
                                <th scope="row">{{ demande.nom_societe }}</th>
                                <td scope="row">{{ demande.libelle_domaine }}</td>
                                <td scope="row">{{ demande.titre }}</td>
                                <td scope="row">{{ demande.type }}</td>

                                <td *ngIf="this.demande.id_etat_offre_stage === 1">Ouvert</td>
                                <td *ngIf="this.demande.id_etat_offre_stage === 2">Fermé</td>

                                <td>
                                  {{
                                    this.sharedService.formatDate(
                                      demande.date_demande,
                                      true
                                    )
                                  }}
                                </td>

                                <td>
                                  <button
                                    class="btn hor-grd ml-2"
                                    id="{{ demande.id_offre_stage }}"
                                    (click)="showDemandeDetails(demande)"
                                    style="background-color: #878787"
                                  >
                                    <i class="icofont icofont-eye-alt" style="color: white;"></i>
                                  </button>
                                </td>
                              </tr>
                            </tbody>
                          </ng-container>
                          <ng-container *ngIf="this.listdemande.length === 0">
                            <tbody>
                              <tr style="text-align: center">
                                <td colspan="5">
                                  AUCUNE DEMANDE ACCEPTÉE POUR L'ANNÉE
                                  {{ this.year }} !
                                </td>
                              </tr>
                            </tbody>
                          </ng-container>
                          <ng-container *ngIf="this.listdemande[0] === null">
                            <tbody>
                              <tr style="text-align: center">
                                <td colspan="5">Chargement ...</td>
                              </tr>
                            </tbody>
                          </ng-container>
                        </table>
                        <!-- Pagination -->
                        <div class="d-flex justify-content-between p-2">
                          <ngb-pagination
                            [(page)]="page"
                            [pageSize]="pageSize"
                            [collectionSize]="listdemande.length"
                          >
                          </ngb-pagination>
                          <!-- Items Par Page  -->
                          <div>
                            Objets par page
:
                            <select
                              class="custom-select"
                              style="width: auto"
                              name="pageSize"
                              (change)="handlePageSizeChange($event)"
                            >
                              <option
                                *ngFor="let size of pageSizes"
                                [ngValue]="size"
                              >
                                {{ size }}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </ngb-tab>

          <ngb-tab title="EN ATTENTE" [id]="2">
            <ng-template ngbTabContent>
              <div class="m-t-15" style="position: relative">
                <!-- info card start -->
                <div class="card">
                  <div class="col-sm-12">
                    <div class="card-header">
                      <h5 class="card-header-text">Liste des demandes</h5>
                    </div>

                    <div class="container">
                      <div class="row">
                        <div class="col-md-6 col-lg-5 offset-lg-1">
                          <div class="pcoded-search">
                            <div class="pcoded-search-box">
                              <input
                                type="text"
                                placeholder="Rechercher"
                                name="search"
                                [(ngModel)]="searchText"
                                autocomplete="off"
                              />
                              <span class="search-icon"
                                ><i class="ti-search" aria-hidden="true"></i
                              ></span>
                            </div>
                          </div>
                        </div>

                        <div class="col-md-6 col-lg-3 offset-lg-2">
                          <div class="input-group">
                            <select
                              ngModel="{{ this.year }}"
                              name="year"
                              class="form-control"
                              (change)="this.changeYear($event.target.value)"
                            >

                              <ng-container *ngFor="let item of this.listYears">
                                <option [value]="item.year">{{ item.year }}</option>
                              </ng-container>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="table-responsive">
                      <div style="margin: 60px; ">
                        <table class="table table-hover">
                          <thead>
                            <ng-container matColumnDef="actions">
                              <mat-header-cell *matHeaderCellDef>
                                Actions
                              </mat-header-cell>
                              <mat-cell *matCellDef="let row">
                                <button mat-button>Edit</button>
                              </mat-cell>
                            </ng-container>
                            <tr style="text-align: center">
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="nom_societe">Entreprise<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="libelle_domaine" >Domaine entreprise<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="titre">Titre<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="type" >Type<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="id_etat_offre_stage" >Etat offre<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col" [appSort]="listdemande" data-order="desc" data-name="date_demande" data-type="date" >Date demande<i class="fa fa-sort" style="margin-left: 10px;"></i></th>
                              <th scope="col"></th>

                            </tr>
                          </thead>
                          <ng-container
                            *ngIf="
                              this.listdemande.length > 0 &&
                              this.listdemande[0] !== null
                            "
                          >
                            <tbody
                              *ngFor="
                                let demande of this.listdemande
                                  | filter: searchText | slice: (page-1) * pageSize : page * pageSize ; let i = index
                              "
                            >
                              <tr style="text-align: center">

                                <th scope="row">{{ demande.nom_societe }}</th>
                                <td scope="row">{{ demande.libelle_domaine }}</td>
                                <td scope="row">{{ demande.titre }}</td>
                                <td scope="row">{{ demande.type }}</td>

                                <td *ngIf="this.demande.id_etat_offre_stage === 1">Ouvert</td>
                                <td *ngIf="this.demande.id_etat_offre_stage === 2">Fermé</td>

                                <td>
                                  {{
                                    this.sharedService.formatDate(
                                      demande.date_demande,
                                      true
                                    )
                                  }}
                                </td>


                                <td>
                                  <button
                                    class="btn hor-grd ml-2"
                                    id="{{ demande.id_offre_stage }}"
                                    (click)="showDemandeDetails(demande)"
                                    style="background-color: #878787"
                                  >
                                    <i class="icofont icofont-eye-alt" style="color : white ;"></i>
                                  </button>
                                </td>
                              </tr>
                            </tbody>
                          </ng-container>
                          <ng-container *ngIf="this.listdemande.length === 0">
                            <tbody>
                              <tr style="text-align: center">
                                <td colspan="5">
                                  AUCUNE DEMANDE MISE EN ATTENTE POUR L'ANNÉE {{ this.year }} !
                                </td>
                              </tr>
                            </tbody>
                          </ng-container>
                          <ng-container *ngIf="this.listdemande[0] === null">
                            <tbody>
                              <tr style="text-align: center">
                                <td colspan="5">Chargement ...</td>
                              </tr>
                            </tbody>
                          </ng-container>
                        </table>
                        <!-- Pagination  -->
                        <div class="d-flex justify-content-between p-2">
                          <ngb-pagination
                            [(page)]="page"
                            [pageSize]="pageSize"
                            [collectionSize]="listdemande.length"
                          >
                          </ngb-pagination>
                          <!-- Items Par Page  -->
                          <div>
                            Objets par page
:
                            <select
                              class="custom-select"
                              style="width: auto"
                              name="pageSize"
                              (change)="handlePageSizeChange($event)"
                            >
                              <option
                                *ngFor="let size of pageSizes"
                                [ngValue]="size"
                              >
                                {{ size }}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </ngb-tab>
        </ngb-tabset>
      </div>
    </div>
  </div>
</ng-container>
